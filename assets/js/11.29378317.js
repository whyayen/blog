(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{493:function(s,e,a){"use strict";a.r(e);var t=a(4),n=Object(t.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"summary"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#summary"}},[s._v("#")]),s._v(" Summary")]),s._v(" "),a("p",[s._v("前一陣子在使用 ELK，想把 MySQL 的資料 sync 到 ELK，需要把 MySQL 設為可以給外部連線，所以紀錄一下有哪些步驟。")]),s._v(" "),a("h2",{attrs:{id:"step-1-編輯-mysql-config"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-1-編輯-mysql-config"}},[s._v("#")]),s._v(" Step 1. 編輯 MySQL config")]),s._v(" "),a("div",{staticClass:"language-bash= line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo vi /etc/mysql/mysql.conf.d/mysqld.cnf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"step-2-編輯-bind-address-為-0-0-0-0"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-2-編輯-bind-address-為-0-0-0-0"}},[s._v("#")]),s._v(" Step 2. 編輯 bind-address 為 0.0.0.0")]),s._v(" "),a("div",{staticClass:"language-bash= line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#\n# Instead of skip-networking the default is now to listen only on\n# localhost which is more compatible and is not less secure.\nbind-address            = 127.0.0.1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("修改成")]),s._v(" "),a("div",{staticClass:"language-bash= line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("bind-address            = 0.0.0.0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("Restart MySQL")]),s._v(" "),a("div",{staticClass:"language-bash= line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo service mysql restart\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("值為 "),a("code",[s._v("127.0.0.1")]),s._v(" 表示僅 localhost 可以進行連線，而如果設為 "),a("code",[s._v("0.0.0.0")]),s._v(" 則允許外部連到 MySQL。")]),s._v(" "),a("h2",{attrs:{id:"step-3-新增-mysql-使用者"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-3-新增-mysql-使用者"}},[s._v("#")]),s._v(" Step 3. 新增 MySQL 使用者")]),s._v(" "),a("div",{staticClass:"language-sql= line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("CREATE USER 'username'@'localhost' IDENTIFIED BY 'user_password';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[a("code",[s._v("username")]),s._v(": 自行替換為你想要的使用者名稱")]),s._v(" "),a("li",[a("code",[s._v("localhost")]),s._v(": 此處為 host，如果值為 "),a("code",[s._v("localhost")]),s._v(" 表示僅允許這個使用者在這台機器上做連線，其他主機不行（SSH 除外），如果要外部連線，請設想連線主機的 IP，\b或也可以使用 "),a("code",[s._v("%")]),s._v(" 代表任何主機都可以進行連線，請謹慎使用 "),a("code",[s._v("%")]),s._v("，盡量將權限、可連線的來源最小化。")]),s._v(" "),a("li",[a("code",[s._v("user_password")]),s._v(": 使用者密碼")])]),s._v(" "),a("h2",{attrs:{id:"step-4-grant-privileges"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-4-grant-privileges"}},[s._v("#")]),s._v(" Step 4. Grant privileges")]),s._v(" "),a("div",{staticClass:"language-sql= line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("GRANT ALL PRIVILEGES ON database_name.table_name TO 'username'@'localhost';\n\nGRANT SELECT, INSERT, DELETE ON database_name.* TO 'username'@'localhost';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("新增使用者的權限，僅允許 "),a("code",[s._v("SELECT")]),s._v(", "),a("code",[s._v("INSERT")]),s._v(", "),a("code",[s._v("DELETE")]),s._v(", "),a("code",[s._v("ALL PRIVILEGES")]),s._v(" 等，並且可以指定資料庫及資料表，例如：我想新增使用者僅允許"),a("strong",[s._v("讀取")]),s._v(" "),a("code",[s._v("development")]),s._v(" 資料庫的 "),a("code",[s._v("users")]),s._v(" 資料表，則可以這樣設定：")]),s._v(" "),a("div",{staticClass:"language-sql= line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("GRANT SELECT ON development_.users TO 'jay'@'localhost';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("Revoke privileges")]),s._v(" "),a("div",{staticClass:"language-bash= line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("REVOKE ALL PRIVILEGES ON database_name.* FROM 'username'@'localhost';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"step-5-遠端連線"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-5-遠端連線"}},[s._v("#")]),s._v(" Step 5. 遠端連線")]),s._v(" "),a("div",{staticClass:"language-bash= line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql -u username -p -h 'xxx.xxx.xxx.xxx'\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);e.default=n.exports}}]);